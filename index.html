<!DOCTYPE html>
<html>

  <head>
	<meta name="generator" content="Hugo 0.91.2" />

  <title>
      
      Saji Weerasingham
      
  </title>

</head>


  <body>

    

	
<div class="h-feed">

	
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/15/some-of-the-conflict-of.html" class="u-url"><time class="dt-published" datetime="2025-03-15 11:50:39 -0800">Mar 15, 2025</time></a>

		<div class="e-content">
			 <p>Some of the conflict of interests various politicians have in their investments, but have not received any punishment despite breaching the ministerial code of conduct #auspol</p>
<p><a href="https://youtube.com/watch?v=sf2QG4MUS7Y&amp;si=HEIJCxbT3PBZvEjl">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/13/some-good-tactical-points-here.html" class="u-url"><time class="dt-published" datetime="2025-03-13 18:28:50 -0800">Mar 13, 2025</time></a>

		<div class="e-content">
			 <p>Some good tactical points here.</p>
<p>I was on the PSG bandwagon before the game, so I&rsquo;m definitely tipping them to win now.</p>
<p>#championsleague #footballtactics</p>
<p><a href="https://open.spotify.com/episode/71MpzO38LVrI2vkZHmjJxU?si=q1Ly7uMoSkG-hwKWkW6J3g">open.spotify.com/episode/7&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/13/you-still-wouldnt-have-enough.html" class="u-url"><time class="dt-published" datetime="2025-03-13 17:49:11 -0800">Mar 13, 2025</time></a>

		<div class="e-content">
			 <p>You still wouldn&rsquo;t have enough for a 20% deposit in most capital cities if in 2014 got a job that put you in the top 80% of earners and saved 15% of your salary for 10 years at the average interest rate #auspol</p>
<p><a href="https://open.spotify.com/episode/0zPQxevWQQb1ejbZhH72Sy?si=47tY-2DAQsiF9jBwmWayMA">open.spotify.com/episode/0&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/12/i-enjoyed-the-history-lesson.html" class="u-url"><time class="dt-published" datetime="2025-03-12 23:30:35 -0800">Mar 12, 2025</time></a>

		<div class="e-content">
			 <p>I enjoyed the history lesson on the start of the Cold War in this podcast episode, and how it relates to #trump and #putin today</p>
<p><a href="https://open.spotify.com/episode/0JDHJSoQmwqB5Qc6MOxK0D?si=6QKrOQVaRlOv_Jfm3kP8CQ">open.spotify.com/episode/0&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/12/love-this-track-trance-trancefamily.html" class="u-url"><time class="dt-published" datetime="2025-03-12 11:50:00 -0800">Mar 12, 2025</time></a>

		<div class="e-content">
			 <p>Love this track #trance #trancefamily</p>
<p><a href="https://open.spotify.com/track/0I8EHyU8Z8Zmo3VqfEzhcL?si=e5_A0LWIRhK4qReKbObysw">open.spotify.com/track/0I8&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/12/fireside-chat-with-david-pocock.html" class="u-url"><time class="dt-published" datetime="2025-03-12 10:40:06 -0800">Mar 12, 2025</time></a>

		<div class="e-content">
			 <p>Fireside chat with David Pocock and Tony Windsor about minority government #auspol</p>
<p><a href="https://open.spotify.com/episode/0CtO8rqqXhBWBQdCsygvNO?si=gedk-ifpSeiNeFGVcvHAlQ">open.spotify.com/episode/0&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/good-chat-with-max-chandlermather.html" class="u-url"><time class="dt-published" datetime="2025-03-11 21:15:04 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>Good chat with Max Chandler-Mather about #thegreens policies.</p>
<p>A rare politician that walks the walk, not just talking.</p>
<p>Gives away part of his salary to help out needy folks in his electorate #auspol</p>
<p><a href="https://open.spotify.com/episode/42LDhBD23gIIgE88g50jPb?si=gSfmUIRAQYeuYG-1rstf-w">open.spotify.com/episode/4&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/the-brics-counties-saudi-arabia.html" class="u-url"><time class="dt-published" datetime="2025-03-11 12:03:03 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>The BRICS counties: Saudi Arabia, Egypt, Iran, Ethiopia, Indonesia and Brazil have the size and resources to have a much bigger influence on the world, bit will it ever happen? #economics #economisexplained</p>
<p><a href="https://youtube.com/watch?v=HrgQxpxh1m8&amp;si=CerepPQNmaPE-6FE">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/so-oldtrafford-will-become-newtrafford.html" class="u-url"><time class="dt-published" datetime="2025-03-11 11:40:20 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>So #oldtrafford will become #newtrafford (more likely the Ineos Arena).</p>
<p>I would have preferred a refurbishment similar to what FSG has done with Anfield, but it appears they want to sell the land around to fund it #manutd #mufc</p>
<p><a href="https://youtube.com/watch?v=gC7KmGvRLkA&amp;si=Dr4A3r540BAAZ68N">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/the-socalled-recent-biggest-terrorist.html" class="u-url"><time class="dt-published" datetime="2025-03-11 11:08:04 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>The so-called recent biggest terrorist plot in Australia&rsquo;s history was a hoax #auspol</p>
<p><a href="https://youtube.com/watch?v=8VdN1tyDyhg&amp;si=VRdSyN3tPHmOn6D5">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/why-you-cant-tax-the.html" class="u-url"><time class="dt-published" datetime="2025-03-11 10:54:19 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>Why you can&rsquo;t tax the resource companies in Australia and win.</p>
<p>TL;DR they&rsquo;ve got deep pockets are will run attack campaigns against you #auspol</p>
<p><a href="https://youtube.com/watch?v=9oSEO8JxS8s&amp;si=Nal7j6LrSbKYWTLk">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/11/remote-filexplorer-in-visualstudio-for.html" class="u-url"><time class="dt-published" datetime="2025-03-11 10:32:36 -0800">Mar 11, 2025</time></a>

		<div class="e-content">
			 <p>Remote #filexplorer in #visualstudio for viewing #linux file systems</p>
<p><a href="https://youtube.com/watch?v=WxsedgP4T0Q&amp;si=oKBY9MF4khRk99c7">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/10/video-about-the-players-in.html" class="u-url"><time class="dt-published" datetime="2025-03-10 14:02:22 -0800">Mar 10, 2025</time></a>

		<div class="e-content">
			 <p>Video about the players in the #manchesterunited U18s that could one day be first team players (includes footage from the FA Youth Cup, not just whiteboarding) #manutd #mufc</p>
<p><a href="https://youtube.com/watch?v=0MwOYUVcPi0&amp;si=JIdBGdo92kG07S8Z">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/10/great-explanation-with-whiteboarding-and.html" class="u-url"><time class="dt-published" datetime="2025-03-10 13:52:46 -0800">Mar 10, 2025</time></a>

		<div class="e-content">
			 <p>Great explanation, with whiteboarding and stats, on why #psg are a better team without #mbappe #footballtactics #championsleague</p>
<p><a href="https://youtube.com/watch?v=1ndelpDVplI&amp;si=XhXSq6leJ_FFNaEl">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/10/this-is-a-great-videostats.html" class="u-url"><time class="dt-published" datetime="2025-03-10 13:16:51 -0800">Mar 10, 2025</time></a>

		<div class="e-content">
			 <p>This is a great video&hellip;stats, whiteboarding etc #theathleticfc #premierleague</p>
<p><a href="https://youtube.com/watch?v=owrS8G3PZUQ&amp;si=5T7zkQTpMi14t8E3">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/09/love-the-irony-that-lib.html" class="u-url"><time class="dt-published" datetime="2025-03-09 13:02:36 -0800">Mar 9, 2025</time></a>

		<div class="e-content">
			 <p>Love the irony that Lib that&rsquo;ll be in charge of government waste is under investigation for 14 breaches use of public money #auspol ðŸ˜‚</p>
<p><a href="https://youtube.com/watch?v=D7Qhz37jluA&amp;si=ESQVZqS3ejizWmrD">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/08/this-is-all-pretty-obvious.html" class="u-url"><time class="dt-published" datetime="2025-03-08 09:08:31 -0800">Mar 8, 2025</time></a>

		<div class="e-content">
			 <p>This is all pretty obvious, but some good discussion points on reworking the wage structure at #manchesterunited #manutd #mufc #glazersout</p>
<p><a href="https://youtu.be/GcIXkpUTGLw?si=My-mUFmdnVlK3Hr9">youtu.be/GcIXkpUTG&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/08/great-video-on-why-amorims.html" class="u-url"><time class="dt-published" datetime="2025-03-08 08:34:32 -0800">Mar 8, 2025</time></a>

		<div class="e-content">
			 <p>Great video on why Amorim&rsquo;s system isn&rsquo;t working on #manchesterunited</p>
<p>It&rsquo;s a lack of running and dribbling ability #mufc #manutd #amorim</p>
<p><a href="https://youtube.com/watch?v=dYd2TkW_b-g&amp;si=i3uMo4owg7I2TtL8">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/08/great-explainer-on-why-a.html" class="u-url"><time class="dt-published" datetime="2025-03-08 07:45:29 -0800">Mar 8, 2025</time></a>

		<div class="e-content">
			 <p>Great explainer on why a tropical cyclone has come down past the tropics #lanina #climatechange</p>
<p><a href="https://youtube.com/watch?v=YVD60z6nqco&amp;si=jPAFbLJaKkZiTamj">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/08/some-excellent-points-about-the.html" class="u-url"><time class="dt-published" datetime="2025-03-08 07:38:15 -0800">Mar 8, 2025</time></a>

		<div class="e-content">
			 <p>Some excellent points about the voting records of the &ldquo;teal independents&rdquo;.</p>
<p>Most are vote with the Liberals except on climate policy.</p>
<p>But, they are looking out for the interests of their electorates #auspol #climate200</p>
<p><a href="https://youtube.com/watch?v=j0gctvGLpVg&amp;si=yb1YoqSDg_eM0mpM">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/07/good-chats-about-google-ai.html" class="u-url"><time class="dt-published" datetime="2025-03-07 12:34:35 -0800">Mar 7, 2025</time></a>

		<div class="e-content">
			 <p>Good chats about Google AI Search and Trump&rsquo;s crypto reserve idea #google #crypto #hardfork #trump</p>
<p><a href="https://open.spotify.com/episode/7vvzQz2VT673u0TaSZBbg8?si=iNalXEBmS022UHXAf7aheA">open.spotify.com/episode/7&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/07/informative-podcast-episode-on-the.html" class="u-url"><time class="dt-published" datetime="2025-03-07 11:01:46 -0800">Mar 7, 2025</time></a>

		<div class="e-content">
			 <p>Informative podcast episode on the justice department operated in Trump&rsquo;s first term and the differences with how it&rsquo;s operating now #trump</p>
<p><a href="https://open.spotify.com/episode/6Ka9Ctt5vPeucdX5m7Dvoz?si=L4FipoKDRoaXQCQZy8fa-w">open.spotify.com/episode/6&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/05/gas-companies-are-paying-almost.html" class="u-url"><time class="dt-published" datetime="2025-03-05 23:13:14 -0800">Mar 5, 2025</time></a>

		<div class="e-content">
			 <p>Gas companies are paying almost $0 in resource rent tax despite making billions #auspol</p>
<p><a href="https://youtube.com/watch?v=6Z7hUkcnN_k&amp;si=HkTHbeR4M0mUfkS7">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/05/informative-podcast-episode-about-the.html" class="u-url"><time class="dt-published" datetime="2025-03-05 12:52:28 -0800">Mar 5, 2025</time></a>

		<div class="e-content">
			 <p>Informative podcast episode about the sporting structure at #manchesterunited #manutd #mufc #talkofthedevils</p>
<p><a href="https://open.spotify.com/episode/2paY4TNmK7yvcmvHrL0cJL?si=1cM_xkhsTfOUoG6mcAR5uw&amp;context=spotify%3Ashow%3A7bQPR7elzVt4UjfH6E25GH">open.spotify.com/episode/2&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/04/the-interview-with-the-ceo.html" class="u-url"><time class="dt-published" datetime="2025-03-04 19:22:07 -0800">Mar 4, 2025</time></a>

		<div class="e-content">
			 <p>The interview with the CEO of #anthropic was quite interesting #ai #artificialintelligence #llms #largelanguagemodels</p>
<p><a href="https://youtube.com/watch?v=YhGUSIvsn_Y&amp;si=Zg3H-CcRDvCI2c9f">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/04/totally-agree-with-this-all.html" class="u-url"><time class="dt-published" datetime="2025-03-04 11:55:16 -0800">Mar 4, 2025</time></a>

		<div class="e-content">
			 <p>Totally agree with this; all #manchesterunited success has been built on youth from the Busby Babes to Fergie&rsquo;s Fledglings #manutd #mufc</p>
<p><a href="https://youtube.com/watch?v=7Z7G3YiWY7E&amp;si=pe3c9ZeZ7NAMkO91">youtube.com/watch</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/03/never-gets-old-trance-trancefamily.html" class="u-url"><time class="dt-published" datetime="2025-03-02 13:33:21 -0800">Mar 2, 2025</time></a>

		<div class="e-content">
			 <p>Never gets old #trance #trancefamily</p>
<p><a href="https://open.spotify.com/track/7tU5JvCfG0t3PHG7mchPjv?si=I5pd56Z-QB2x8BAdwJs2_A">open.spotify.com/track/7tU&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/01/love-michael-west-doesnt-care.html" class="u-url"><time class="dt-published" datetime="2025-03-01 15:28:10 -0800">Mar 1, 2025</time></a>

		<div class="e-content">
			 <p>Love Michael West, doesn&rsquo;t care about the repercussions, just called it as he sees it #auspol</p>
<p><a href="https://youtu.be/0wD76ESIKZM?si=Nfc2NoUflS5QUXv9">youtu.be/0wD76ESIK&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/02/i-got-on-the-abc.html" class="u-url"><time class="dt-published" datetime="2025-03-01 12:06:26 -0800">Mar 1, 2025</time></a>

		<div class="e-content">
			 <p>I got 6.5/7 on the ABC Civics Quiz that they say that year 10 students should know #auspol</p>
<p><a href="https://www.abc.net.au/news/2025-02-19/quiz-civics-australian-democracy-acara-test-results/104949450">www.abc.net.au/news/2025&hellip;</a></p>
<!-- raw HTML omitted -->

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/03/01/football-and-footballtactics-evolve-so.html" class="u-url"><time class="dt-published" datetime="2025-02-28 14:06:41 -0800">Feb 28, 2025</time></a>

		<div class="e-content">
			 <p>#football and #footballtactics evolve so quickly these days</p>
<p><a href="https://open.spotify.com/episode/27VTDk3ho3PyLKXimF0TnY?si=G0-WgtMvTNePYGaPso2QqA">open.spotify.com/episode/2&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/27/life-is-indeed-stranger-than.html" class="u-url"><time class="dt-published" datetime="2025-02-26 23:45:09 -0800">Feb 26, 2025</time></a>

		<div class="e-content">
			 <p>Life is indeed stranger than fiction as this seems more interesting than #succession #murdoch</p>
<p><a href="https://open.spotify.com/episode/2YZx2mY3CAW8oiPQsYpPAb?si=SGVMoGwIRqCT73vF5LP6qQ">open.spotify.com/episode/2&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/27/and-its-hard-to-hold.html" class="u-url"><time class="dt-published" datetime="2025-02-26 11:58:23 -0800">Feb 26, 2025</time></a>

		<div class="e-content">
			 <p>And it&rsquo;s hard to hold a candle, in the cold Manchester rain #munips #mufc #manchesterunited</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/25/make-your-own-mind-up.html" class="u-url"><time class="dt-published" datetime="2025-02-24 12:03:55 -0800">Feb 24, 2025</time></a>

		<div class="e-content">
			 <p>Make your own mind up on the PM&rsquo;s performance on #qanda #auspol</p>
<p><a href="https://www.youtube.com/live/mx8k9k83sWw?si=WDeJL9w48Vv_5DBG">www.youtube.com/live/mx8k&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/24/great-video-with-examples-that.html" class="u-url"><time class="dt-published" datetime="2025-02-23 18:25:58 -0800">Feb 23, 2025</time></a>

		<div class="e-content">
			 <p>Great video, with examples, that explains how preferential voting works in #auspol</p>
<p><a href="https://youtu.be/YiLAx7kp4Rc?si=Oy0jLQMpZzB1mkwh">youtu.be/YiLAx7kp4&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/24/its-a-shame-to-see.html" class="u-url"><time class="dt-published" datetime="2025-02-23 15:53:07 -0800">Feb 23, 2025</time></a>

		<div class="e-content">
			 <p>It&rsquo;s a shame to see that our Matildas are just not in the same class as best national women&rsquo;s teams, despite having a lot a players playing in the English WSL #matildas</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/22/maguire-ballwatching-on-that-second.html" class="u-url"><time class="dt-published" datetime="2025-02-22 05:37:47 -0800">Feb 22, 2025</time></a>

		<div class="e-content">
			 <p>Maguire, ball-watching on that second goal, as usual.</p>
<p>He never scans! #manutd #manchesterunited</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/22/elon-wont-be-able-to.html" class="u-url"><time class="dt-published" datetime="2025-02-21 23:07:52 -0800">Feb 21, 2025</time></a>

		<div class="e-content">
			 <p>#elon won&rsquo;t be able to cut $2 trillion from the US federal budget, here&rsquo;s why: <a href="https://youtu.be/lG9pxvpGY-Q?si=vIefVZreW5mDAAvg">youtu.be/lG9pxvpGY&hellip;</a></p>
<p>#trump #politics</p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/22/nuclearfusion-reactor-run-for-minutes.html" class="u-url"><time class="dt-published" datetime="2025-02-21 21:44:04 -0800">Feb 21, 2025</time></a>

		<div class="e-content">
			 <p>#nuclearfusion reactor run for 22 minutes in France #energytransition #netzero</p>
<p><a href="https://newatlas.com/energy/france-tokamak-cea-west-fusion-reactor-record-plasma-duration/">newatlas.com/energy/fr&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/22/toxic-culture-in-spanish-football.html" class="u-url"><time class="dt-published" datetime="2025-02-21 12:05:51 -0800">Feb 21, 2025</time></a>

		<div class="e-content">
			 <p>Toxic culture in Spanish football as exposed by the Rubiales kiss #womensfootball</p>
<p><a href="https://youtu.be/nbLH9sXAGLE?si=tS1QYR2ncIwQmrWV">youtu.be/nbLH9sXAG&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/21/the-worlds-largest-electric-ferry.html" class="u-url"><time class="dt-published" datetime="2025-02-21 11:13:27 -0800">Feb 21, 2025</time></a>

		<div class="e-content">
			 <p>The world&rsquo;s largest electric ferry #renewableenergy</p>
<p><a href="https://youtu.be/4rR57tXdOHQ?si=UDzJPnLmhUPfEq6t">youtu.be/4rR57tXdO&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/21/dont-believe-everything-you-hear.html" class="u-url"><time class="dt-published" datetime="2025-02-20 18:46:44 -0800">Feb 20, 2025</time></a>

		<div class="e-content">
			 <p>Don&rsquo;t believe everything you hear about making the public service smaller and more efficient #auspol</p>
<p><a href="https://youtu.be/j2X7ICTqiOc?si=DFUxRS32oz5sMyhz">youtu.be/j2X7ICTqi&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/21/if-youre-a-windows-user.html" class="u-url"><time class="dt-published" datetime="2025-02-20 17:26:21 -0800">Feb 20, 2025</time></a>

		<div class="e-content">
			 <p>If you&rsquo;re a Windows user and wished File Explorer could do more, then check these out #windows #fileexplorer</p>
<p><a href="https://youtu.be/uDUQrC5YxT0?si=A8wzTheIsWVvFiP5">youtu.be/uDUQrC5Yx&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/21/great-chat-about-manchesterunited-especially.html" class="u-url"><time class="dt-published" datetime="2025-02-20 12:17:44 -0800">Feb 20, 2025</time></a>

		<div class="e-content">
			 <p>Great chat about #manchesterunited especially Ten Hag&rsquo;s man-management issues, the precarious financial position, where the #glazersout movement is, and how Sir Jim is going so far</p>
<p><a href="https://open.spotify.com/episode/4WYeg7duHhs515R30owBIQ?si=mpmxpkPIR1mz_F-Nb38h0g">open.spotify.com/episode/4&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/21/i-found-this-super-interesting.html" class="u-url"><time class="dt-published" datetime="2025-02-20 11:25:16 -0800">Feb 20, 2025</time></a>

		<div class="e-content">
			 <p>I found this super interesting #football #footballanalytics #ai #bigdata</p>
<p><a href="https://open.spotify.com/episode/1c6H6gR5eB91Wg2YoGmaiM?si=wtBdDOt2SfeFpjU_LOBArA">open.spotify.com/episode/1&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/20/good-history-lesson-on-australian.html" class="u-url"><time class="dt-published" datetime="2025-02-19 22:02:50 -0800">Feb 19, 2025</time></a>

		<div class="e-content">
			 <p>Good history lesson on Australian interest rates and why things are so expensive.</p>
<p>Spoiler, it&rsquo;s not a domestic issue.</p>
<p>#auspol #costoflivingcrisis
<a href="https://open.spotify.com/episode/0a94fRXCVwYmxInr7iBlOW?si=a0OsrIdYSR6le93YnpJijw">open.spotify.com/episode/0&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		

		<a href="https://sajilicious.micro.blog/2025/02/16/informative-video-listing-the-events.html" class="u-url"><time class="dt-published" datetime="2025-02-15 12:34:33 -0800">Feb 15, 2025</time></a>

		<div class="e-content">
			 <p>Informative video listing the events that shaped Trump&rsquo;s idea to acquire Palestinian-occupied territories for American real estate developments #gaza #westbank</p>
<p><a href="https://youtu.be/DdUGdSEXkQU?si=lgPUu0tovHUPBdEs">youtu.be/DdUGdSEXk&hellip;</a></p>

		</div>
	  </div>
	
	  <div class="h-entry">
		
			<h1><a href="https://sajilicious.micro.blog/2025/02/15/domain-event-dispatching-using-the.html">Domain event dispatching using the outbox pattern with Entity Framework</a></h1>
		

		<a href="https://sajilicious.micro.blog/2025/02/15/domain-event-dispatching-using-the.html" class="u-url"><time class="dt-published" datetime="2025-02-14 08:33:16 -0800">Feb 14, 2025</time></a>

		<div class="e-content">
			 <h2 id="what-is-domain-event-dispatching">What is domain event dispatching?</h2>
<p>Domain event dispatching is a concept that related to <a href="https://martinfowler.com/bliki/DomainDrivenDesign.html">domain-driven design</a>, or DDD as it&rsquo;s also known.</p>
<p>Having said that, event dispatching is central to any <a href="https://learn.microsoft.com/en-us/azure/architecture/guide/architecture-styles/event-driven">event-driven architecture</a>, which follows the <a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/publisher-subscriber">publisher-subscriber pattern</a>.</p>
<p>Now, I&rsquo;ve not actually read Eric Evans' seminal book on domain-driven design, <a href="https://www.amazon.com.au/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215">Domain-driven Design: Tackling Complexity in the Heart of Software</a>, so I&rsquo;m unsure whether Evans suggests whether domain events should be published as part of the transaction that creates them, or have the event persisted with the change in application state and then later published using an <a href="https://codeopinion.com/outbox-pattern-reliably-save-state-publish-events">outbox pattern</a>.</p>
<p>I prefer the outbox pattern for domain event dispatching because I don&rsquo;t think you want a scenario where data is persisted and an event is raised that has multiple subscribers, but one of the subscribers fails to execute, causing the whole transation to be rolled back.</p>
<p>You then get an inconsistent scenario where certain event handlers have been handled, but the data that relates to those actions does not exist.  Why send a confirmation email for an account that wasn&rsquo;t successfully regsitered.</p>
<p>Or, conversely, the transaction is not rolled back and one subscriber has failed to execute (including retries with back-off).</p>
<p>The outbox pattern, keeps a record of whether the event has been dispatched or &ldquo;sent&rdquo;, behaving a bit like a service bus.</p>
<p>In this blog post, I&rsquo;m going to explore how an application using <a href="https://learn.microsoft.com/en-us/aspnet/entity-framework">Entity Framework</a> as an ORM can use an outbox pattern to publish domain events that are persisted with the application data.</p>
<p>The packages used will be Entity Framewok and I will leverage <code>INotification</code> in <a href="https://github.com/jbogard/MediatR">MediatR</a> to assist with the publisher-subscriber implementation.</p>
<p>All of these code samples are taken from my <a href="https://github.com/TheMagnificent11/lewee">Lewee</a> project.</p>
<h2 id="domain-event">Domain Event</h2>
<p>Here&rsquo;s rough representation of a domain event.</p>
<p>I&rsquo;ve included a <code>CorrelationId</code> property that I believe should be set to allow you to correlate the logs from the original transaction that persisted the <a href="https://martinfowler.com/bliki/DDD_Aggregate.html">aggregate root</a> and all the subsequent events that get handled as part of the dispatching.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> MediatR;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> IDomainEvent : INotification
{
    Guid CorrelationId { <span style="color:#66d9ef">get</span>; }
}
</code></pre></div><p>And here&rsquo;s a sample implementation of an menu item being added to the table&rsquo;s order at a restaurant.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MenuItemAddedToOrderDomainEvent</span> : IDomainEvent
{
    <span style="color:#66d9ef">public</span> MenuItemAddedToOrderDomainEvent(
        Guid correlationId,
        Guid tableId,
        <span style="color:#66d9ef">int</span> tableNumber,
        Guid orderId,
        Guid menuItemId,
        <span style="color:#66d9ef">decimal</span> price)
    {
        <span style="color:#66d9ef">this</span>.CorrelationId = correlationId;
        <span style="color:#66d9ef">this</span>.TableId = tableId;
        <span style="color:#66d9ef">this</span>.TableNumber = tableNumber;
        <span style="color:#66d9ef">this</span>.OrderId = orderId;
        <span style="color:#66d9ef">this</span>.MenuItemId = menuItemId;
        <span style="color:#66d9ef">this</span>.Price = price;
    }


    <span style="color:#66d9ef">public</span> Guid CorrelationId { <span style="color:#66d9ef">get</span>; }
    <span style="color:#66d9ef">public</span> Guid TableId { <span style="color:#66d9ef">get</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> TableNumber { <span style="color:#66d9ef">get</span>; }
    <span style="color:#66d9ef">public</span> Guid OrderId { <span style="color:#66d9ef">get</span>; }
    <span style="color:#66d9ef">public</span> Guid MenuItemId { <span style="color:#66d9ef">get</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">decimal</span> Price { <span style="color:#66d9ef">get</span>; }
}
</code></pre></div><h2 id="storing-domain-events">Storing Domain Events</h2>
<h3 id="entity-framework-entity">Entity Framework Entity</h3>
<p>Below is entity class used to store the details about a domain event after it related aggregate root has been persisted.</p>
<p>Things to note, we are storing the domain event as JSON (<code>DomainEventJson</code>) and also storing the assembly name (<code>DomainEventAssemblyName</code>) and class name (<code>DomainEventClassName</code>) to allow us to deserialize the JSON back to the doamin event in the <code>ToDomainEvent</code> method.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> System.Reflection;
<span style="color:#66d9ef">using</span> System.Text.Json;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventReference</span>
{
    <span style="color:#66d9ef">public</span> DomainEventReference(DomainEvent domainEvent)
    {
        <span style="color:#66d9ef">this</span>.Id = Guid.NewGuid();
        <span style="color:#66d9ef">this</span>.DomainEventAssemblyName = assemblyName;
        <span style="color:#66d9ef">this</span>.DomainEventClassName = fullClassName;
        <span style="color:#66d9ef">this</span>.DomainEventJson = JsonSerializer.Serialize(domainEvent, domainEventType);
        <span style="color:#66d9ef">this</span>.PersistedAt = DateTime.UtcNow;
        <span style="color:#66d9ef">this</span>.Dispatched = <span style="color:#66d9ef">false</span>;
    }


    <span style="color:#75715e">// EF constructor
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> DomainEventReference()
    {
        <span style="color:#66d9ef">this</span>.DomainEventAssemblyName = <span style="color:#66d9ef">string</span>.Empty;
        <span style="color:#66d9ef">this</span>.DomainEventClassName = <span style="color:#66d9ef">string</span>.Empty;
        <span style="color:#66d9ef">this</span>.DomainEventJson = <span style="color:#e6db74">&#34;{}&#34;</span>;
        <span style="color:#66d9ef">this</span>.PersistedAt = DateTime.UtcNow;
        <span style="color:#66d9ef">this</span>.Dispatched = <span style="color:#66d9ef">false</span>;
    }


    <span style="color:#66d9ef">public</span> Guid Id { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> DomainEventAssemblyName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> DomainEventClassName { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> DomainEventJson { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> Dispatched { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> DateTime PersistedAt { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> DateTime? DispatchedAt { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }


    <span style="color:#66d9ef">public</span> DomainEvent? ToDomainEvent()
    {
        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">string</span>.IsNullOrWhiteSpace(<span style="color:#66d9ef">this</span>.DomainEventJson))
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
        }


        <span style="color:#66d9ef">var</span> assembly = Assembly.Load(<span style="color:#66d9ef">this</span>.DomainEventAssemblyName);
        <span style="color:#66d9ef">var</span> targetType = assembly.GetType(<span style="color:#66d9ef">this</span>.DomainEventClassName);


        <span style="color:#66d9ef">if</span> (targetType == <span style="color:#66d9ef">null</span>)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
        }


        <span style="color:#66d9ef">var</span> objDomainEvent = Deserialize(<span style="color:#66d9ef">this</span>.DomainEventJson, targetType);
        <span style="color:#66d9ef">if</span> (objDomainEvent <span style="color:#66d9ef">is</span> not DomainEvent domainEvent)
        {
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
        }


        domainEvent.UserId = <span style="color:#66d9ef">this</span>.UserId;


        <span style="color:#66d9ef">return</span> domainEvent;


        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">object?</span> Deserialize(<span style="color:#66d9ef">string</span> json, Type type)
        {
            <span style="color:#66d9ef">try</span>
            {
                <span style="color:#66d9ef">return</span> JsonSerializer.Deserialize(json, type);
            }
            <span style="color:#66d9ef">catch</span>
            {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
            }
        }
    }


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Dispatch()
    {
        <span style="color:#66d9ef">this</span>.Dispatched = <span style="color:#66d9ef">true</span>;
        <span style="color:#66d9ef">this</span>.DispatchedAt = DateTime.UtcNow;
    }
}
</code></pre></div><p>And here&rsquo;s how we&rsquo;ve configured the underlying database table.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;
<span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore.Metadata.Builders;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventReferenceConfiguration</span> : IEntityTypeConfiguration&lt;DomainEventReference&gt;
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Configure(EntityTypeBuilder&lt;DomainEventReference&gt; builder)
    {
        builder.HasKey(x =&gt; x.Id);


        builder.Property(x =&gt; x.DomainEventAssemblyName)
            .HasMaxLength(<span style="color:#ae81ff">255</span>)
            .IsRequired();


        builder.Property(x =&gt; x.DomainEventClassName)
            .HasMaxLength(<span style="color:#ae81ff">255</span>)
            .IsRequired();


        builder.Property(x =&gt; x.DomainEventJson)
            .HasMaxLength(<span style="color:#ae81ff">8000</span>)
            .IsRequired();


        builder.Property(x =&gt; x.Dispatched)
            .IsRequired();


        builder.Property(x =&gt; x.PersistedAt)
            .IsRequired();


        builder.Property(x =&gt; x.DispatchedAt)
            .IsRequired(<span style="color:#66d9ef">false</span>);


        builder.Property(x =&gt; x.UserId)
            .HasMaxLength(<span style="color:#ae81ff">50</span>);


        builder.HasIndex(
            nameof(DomainEventReference.Dispatched),
            nameof(DomainEventReference.PersistedAt));
    }
}
</code></pre></div><h3 id="how-the-aggregate-root-stores-the-domain-event">How the aggregate root stores the domain event</h3>
<p>The aggregate root needs a collection of domain events on it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventsCollection</span>
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> List&lt;DomainEvent&gt; domainEvents = <span style="color:#66d9ef">new</span>();
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> <span style="color:#66d9ef">object</span> syncLock = <span style="color:#66d9ef">new</span>();


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Raise&lt;T&gt;(T domainEvent)
        <span style="color:#66d9ef">where</span> T : DomainEvent
    {
        <span style="color:#66d9ef">lock</span> (<span style="color:#66d9ef">this</span>.syncLock)
        {
            <span style="color:#66d9ef">this</span>.domainEvents.Add(domainEvent);
        }
    }


    <span style="color:#66d9ef">public</span> DomainEvent[] GetAndClear()
    {
        <span style="color:#66d9ef">lock</span> (<span style="color:#66d9ef">this</span>.syncLock)
        {
            <span style="color:#66d9ef">var</span> events = <span style="color:#66d9ef">this</span>.domainEvents.ToArray();
            <span style="color:#66d9ef">this</span>.domainEvents.Clear();


            <span style="color:#66d9ef">return</span> events;
        }
    }
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AggregateRoot</span> : Entity
{
    <span style="color:#66d9ef">protected</span> AggregateRoot()
        : <span style="color:#66d9ef">base</span>(Guid.NewGuid())
    {
    }


    <span style="color:#66d9ef">protected</span> AggregateRoot(Guid id)
        : <span style="color:#66d9ef">base</span>(id)
    {
    }


    <span style="color:#66d9ef">public</span> DomainEventsCollection DomainEvents { <span style="color:#66d9ef">get</span>; } = <span style="color:#66d9ef">new</span> DomainEventsCollection();
}
</code></pre></div><p>And here&rsquo;s a sample implementation of an aggregate root &ldquo;raising&rdquo; a domain event.</p>
<p>In this example, a menu item is being added to the order of a table at a restaurant.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Table</span> : AggregateRoot
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> List&lt;Order&gt; orders = <span style="color:#66d9ef">new</span>();


    <span style="color:#66d9ef">public</span> Table(Guid id, <span style="color:#66d9ef">int</span> tableNumber)
        : <span style="color:#66d9ef">base</span>(id)
    {
        <span style="color:#66d9ef">this</span>.TableNumber = tableNumber;
    }


    <span style="color:#66d9ef">public</span> Order? CurrentOrder =&gt; <span style="color:#66d9ef">this</span>.orders
        .Where(x =&gt; x.OrderStatusId != OrderStatus.Paid)
        .Where(x =&gt; !x.IsDeleted)
        .OrderByDescending(x =&gt; x.CreatedAtUtc)
        .FirstOrDefault();


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> TableNumber { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">bool</span> IsInUse { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">set</span>; }
    <span style="color:#66d9ef">public</span> IReadOnlyCollection&lt;Order&gt; Orders =&gt; <span style="color:#66d9ef">this</span>.orders;


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> OrderMenuItem(MenuItem menuItem, Guid correlationId)
    {
        <span style="color:#66d9ef">if</span> (!<span style="color:#66d9ef">this</span>.IsInUse || <span style="color:#66d9ef">this</span>.CurrentOrder == <span style="color:#66d9ef">null</span>)
        {
            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DomainException(ErrorMessages.CannotOrderIfTableNotInUse);
        }


        <span style="color:#66d9ef">this</span>.CurrentOrder.AddItem(menuItem);


        <span style="color:#66d9ef">this</span>.DomainEvents.Raise(<span style="color:#66d9ef">new</span> MenuItemAddedToOrderDomainEvent(
            correlationId,
            <span style="color:#66d9ef">this</span>.Id,
            <span style="color:#66d9ef">this</span>.TableNumber,
            <span style="color:#66d9ef">this</span>.CurrentOrder.Id,
            menuItem.Id,
            menuItem.Price));
    }


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ErrorMessages</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">string</span> CannotOrderIfTableNotInUse = <span style="color:#e6db74">&#34;Cannot order items if table is not in use&#34;</span>;
    }
}
</code></pre></div><h3 id="how-the-dbcontext-stores-the-domain-event">How the DbContext stores the domain event</h3>
<p>We are going to use a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.diagnostics.savechangesinterceptor">SaveChangesInterceptor</a> to find the domain events added to our aggregate roots and add them as <code>DomainEventReference</code> instances before &ldquo;save changes&rdquo; executes.</p>
<p>To do that, we need to be able easily identify the <code>DbSet</code> for our <code>DomainEventReference</code> entities.</p>
<p>So, we&rsquo;ve created an <code>IApplicationDbContext</code> interface that we can add to our Entity Framework <code>DbContext</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> IApplicationDbContext
{
    DbSet&lt;DomainEventReference&gt;? DomainEventReferences { <span style="color:#66d9ef">get</span>; }
}
</code></pre></div><p>And here&rsquo;s the interceptor that find the domain events on the aggregate roots and stores them in the <code>DbContext</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;
<span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore.ChangeTracking;
<span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore.Diagnostics;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventSaveChangesInterceptor</span>&lt;TContext&gt; : SaveChangesInterceptor
    <span style="color:#66d9ef">where</span> TContext : DbContext, IApplicationDbContext
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> InterceptionResult&lt;<span style="color:#66d9ef">int</span>&gt; SavingChanges(
        DbContextEventData eventData,
        InterceptionResult&lt;<span style="color:#66d9ef">int</span>&gt; result)
    {
        <span style="color:#66d9ef">this</span>.StoreDomainEvents(eventData.Context);


        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.SavingChanges(eventData, result);
    }


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> ValueTask&lt;InterceptionResult&lt;<span style="color:#66d9ef">int</span>&gt;&gt; SavingChangesAsync(
        DbContextEventData eventData,
        InterceptionResult&lt;<span style="color:#66d9ef">int</span>&gt; result,
        CancellationToken cancellationToken = <span style="color:#66d9ef">default</span>)
    {
        <span style="color:#66d9ef">this</span>.StoreDomainEvents(eventData.Context);


        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.SavingChangesAsync(eventData, result, cancellationToken);
    }


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> StoreDomainEvents(DbContext? context)
    {
        <span style="color:#66d9ef">if</span> (context == <span style="color:#66d9ef">null</span> || context <span style="color:#66d9ef">is</span> not TContext)
        {
            <span style="color:#66d9ef">return</span>;
        }


        <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> entry <span style="color:#66d9ef">in</span> context.ChangeTracker.Entries().ToList())
        {
            <span style="color:#66d9ef">this</span>.StoreDomainEventsForEntry((TContext)context, entry);
        }
    }


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> StoreDomainEventsForEntry(TContext context, EntityEntry entry)
    {
        <span style="color:#66d9ef">if</span> (entry.Entity <span style="color:#66d9ef">is</span> not AggregateRoot aggregateRootEntity)
        {
            <span style="color:#66d9ef">return</span>;
        }


        <span style="color:#66d9ef">var</span> events = aggregateRootEntity.DomainEvents.GetAndClear();


        <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> domainEvent <span style="color:#66d9ef">in</span> events)
        {
            <span style="color:#66d9ef">if</span> (domainEvent == <span style="color:#66d9ef">null</span>)
            {
                <span style="color:#66d9ef">continue</span>;
            }


            <span style="color:#66d9ef">var</span> reference = <span style="color:#66d9ef">new</span> DomainEventReference(domainEvent);


            context.DomainEventReferences?.Add(reference);
        }
    }
}
</code></pre></div><p>Finally, here&rsquo;s an abstract <code>DbContext</code> implementation that exposes the <code>DomainEventReference</code> <code>DbSet</code> and adds the <code>DomainEventSaveChangesInterceptor</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ApplicationDbContext</span>&lt;TContext&gt; : DbContext, IApplicationDbContext
    <span style="color:#66d9ef">where</span> TContext : DbContext, IApplicationDbContext
{
    <span style="color:#66d9ef">protected</span> ApplicationDbContext(DbContextOptions&lt;TContext&gt; options)
        : <span style="color:#66d9ef">base</span>(options)
    {
    }


    <span style="color:#66d9ef">public</span> DbSet&lt;DomainEventReference&gt;? DomainEventReferences { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">set</span>; }


    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> OnModelCreating(ModelBuilder modelBuilder)
    {
        <span style="color:#66d9ef">base</span>.OnModelCreating(modelBuilder);


        modelBuilder.ApplyConfiguration(<span style="color:#66d9ef">new</span> DomainEventReferenceConfiguration());


        <span style="color:#66d9ef">this</span>.ConfigureDatabaseModel(modelBuilder);
    }


    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">void</span> OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        <span style="color:#66d9ef">base</span>.OnConfiguring(optionsBuilder);


        optionsBuilder.AddInterceptors(<span style="color:#66d9ef">new</span> DomainEventSaveChangesInterceptor&lt;TContext&gt;());
    }


    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">void</span> ConfigureDatabaseModel(ModelBuilder modelBuilder);
}
</code></pre></div><h2 id="dispatching-domain-events">Dispatching Domain Events</h2>
<p>The code below reads from the database table for the <code>DomainEventReference</code> entity and dispatches them in batches of 50.</p>
<p>For event row, it deserializes the JSON to the original <code>IDomainEvent</code> and because <code>IDomainEvent</code> implements <code>INotification</code> from <code>MediatR</code>, you can use the <code>Publish</code> to achieve the publisher-subscriber pattern; there can be multiple notification handlers for each event.  Conversely, if there are not notification handlers, <code>MediatR</code> will handle this for us and return successfully.</p>
<p>The domain event does not get marked as &ldquo;dispatched&rdquo; in the database unless all dispatching succeeds.</p>
<p>There is a downside here because you could have three notification handlers for an event, two could succeed and one could fail, causing the event does not get marked as dispatched.</p>
<p>Any process that tries to re-dispatch will attempt all three handlers again, so you could get duplication of certain handlers.</p>
<p>However, I think this is still better than the other scenario I outlined earlier.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> MediatR;
<span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;
<span style="color:#66d9ef">using</span> Serilog;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventDispatcher</span>&lt;TContext&gt;
    <span style="color:#66d9ef">where</span> TContext : DbContext, IApplicationDbContext
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> BatchSize = <span style="color:#ae81ff">50</span>;


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> IDbContextFactory&lt;TContext&gt; dbContextFactory;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> IMediator mediator;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> ILogger logger;


    <span style="color:#66d9ef">public</span> DomainEventDispatcher(
        IDbContextFactory&lt;TContext&gt; dbContextFactory,
        IMediator mediator,
        ILogger logger)
    {
        <span style="color:#66d9ef">this</span>.dbContextFactory = dbContextFactory;
        <span style="color:#66d9ef">this</span>.mediator = mediator;
        <span style="color:#66d9ef">this</span>.logger = logger.ForContext&lt;DomainEventDispatcher&lt;TContext&gt;&gt;();
    }


    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task DispatchEvents(CancellationToken cancellationToken)
    {
        <span style="color:#66d9ef">var</span> eventsToDispatch = <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.ThereAreEventsToDispatch(cancellationToken);


        <span style="color:#66d9ef">while</span> (eventsToDispatch &amp;&amp; !cancellationToken.IsCancellationRequested)
        {
            <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.DispatchBatch(cancellationToken);


            eventsToDispatch = <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.ThereAreEventsToDispatch(cancellationToken);
        }
    }


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">async</span> Task&lt;<span style="color:#66d9ef">bool</span>&gt; ThereAreEventsToDispatch(CancellationToken token)
    {
        <span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> scope = <span style="color:#66d9ef">this</span>.dbContextFactory.CreateDbContext())
        {
            <span style="color:#66d9ef">var</span> dbSet = scope.Set&lt;DomainEventReference&gt;();


            <span style="color:#66d9ef">if</span> (dbSet == <span style="color:#66d9ef">null</span>)
            {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
            }


            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> dbSet
                .Where(x =&gt; !x.Dispatched)
                .OrderBy(x =&gt; x.PersistedAt)
                .AnyAsync(token);
        }
    }


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">async</span> Task DispatchBatch(CancellationToken token)
    {
        <span style="color:#66d9ef">using</span> (<span style="color:#66d9ef">var</span> scope = <span style="color:#66d9ef">this</span>.dbContextFactory.CreateDbContext())
        {
            <span style="color:#66d9ef">var</span> dbSet = scope.Set&lt;DomainEventReference&gt;();
            <span style="color:#66d9ef">if</span> (dbSet == <span style="color:#66d9ef">null</span>)
            {
                <span style="color:#66d9ef">return</span>;
            }


            <span style="color:#66d9ef">var</span> events = <span style="color:#66d9ef">await</span> dbSet
                .Where(x =&gt; !x.Dispatched)
                .OrderBy(x =&gt; x.PersistedAt)
                .Take(BatchSize)
                .ToArrayAsync(token);


            <span style="color:#66d9ef">var</span> domainEvents = <span style="color:#66d9ef">new</span> List&lt;DomainEvent&gt;();


            <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> domainEventReference <span style="color:#66d9ef">in</span> events)
            {
                domainEventReference.Dispatch();


                <span style="color:#66d9ef">var</span> domainEvent = domainEventReference.ToDomainEvent();


                <span style="color:#66d9ef">if</span> (domainEvent == <span style="color:#66d9ef">null</span>)
                {
                    <span style="color:#66d9ef">this</span>.logger.Warning(
                        <span style="color:#e6db74">&#34;Could not deserialize DomainEventReference {Id}&#34;</span>,
                        domainEventReference.Id);
                }
                <span style="color:#66d9ef">else</span>
                {
                    domainEvents.Add(domainEvent);
                }
            }


            <span style="color:#66d9ef">if</span> (domainEvents.Any())
            {
                <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> domainEvent <span style="color:#66d9ef">in</span> domainEvents)
                {
                    <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.mediator.Publish(domainEvent, token);
                }
            }


            <span style="color:#66d9ef">await</span> scope.SaveChangesAsync(token);
        }
    }
}
</code></pre></div><p>So the code above does the dispatching, but what triggers the dispatching?</p>
<p>As far as I know, there is nothing similar to the <code>SaveChangesInterceptor</code> that executes after a successful save changes.</p>
<p>So, we&rsquo;ve decided to use a background service.</p>
<p>In the code below, we are expecting our <code>DomainEventDispatcher</code> to dispatch events every 2.5 seconds.</p>
<p>So, any events that failed to dispatch will be retried after 2.5 seconds.</p>
<p><code>DomainEventReference</code> does not currently have a &ldquo;retry count&rdquo; or a &ldquo;failed&rdquo; property and that is definitely an improvement that could be added; fail if retried 10 times.</p>
<p>Under this solution, we will keep retrying and failed events will be attempted before new events, potentially causing a performance issue if failed events build up.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;
<span style="color:#66d9ef">using</span> Microsoft.Extensions.Hosting;


<span style="color:#66d9ef">namespace</span> Lewee.Infrastructure.Data;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DomainEventDispatcherService</span>&lt;TContext&gt; : BackgroundService
    <span style="color:#66d9ef">where</span> TContext : DbContext, IApplicationDbContext
{
    <span style="color:#66d9ef">public</span> DomainEventDispatcherService(DomainEventDispatcher&lt;TContext&gt; domainEventDispatcher)
    {
        <span style="color:#66d9ef">this</span>.DomainEventDispatcher = domainEventDispatcher;
    }


    <span style="color:#66d9ef">public</span> DomainEventDispatcher&lt;TContext&gt; DomainEventDispatcher { <span style="color:#66d9ef">get</span>; }


    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">async</span> Task ExecuteAsync(CancellationToken stoppingToken)
    {
        <span style="color:#66d9ef">while</span> (!stoppingToken.IsCancellationRequested)
        {
            <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.DomainEventDispatcher.DispatchEvents(stoppingToken);


            <span style="color:#66d9ef">await</span> Task.Delay(<span style="color:#ae81ff">2500</span>, stoppingToken);
        }
    }
}
</code></pre></div><p>There are definitely better ways to achieve this.</p>
<p>You could override save changes on your <code>DbContext</code> to trigger your domain event dispatcher and later you use some sort of retry policy if any events fails to dispatch.</p>
<p>That would be more efficient, but more complicated and harder to implement.</p>
<h2 id="dependency-injection-configuration">Dependency Injection Configuration</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cs" data-lang="cs"><span style="color:#66d9ef">using</span> Microsoft.EntityFrameworkCore;
<span style="color:#66d9ef">using</span> Microsoft.Extensions.DependencyInjection;


<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ApplicationDbContextServiceCollectionExtensions</span>
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> IServiceCollection ConfigureDatabase&lt;T&gt;(
        <span style="color:#66d9ef">this</span> IServiceCollection services,
        <span style="color:#66d9ef">string</span> connectionString)
        <span style="color:#66d9ef">where</span> T : ApplicationDbContext&lt;T&gt;
    {
        services.AddDbContextFactory&lt;T&gt;(options =&gt; options.UseSqlServer(connectionString));
        services.AddScoped&lt;T&gt;();


        services.AddSingleton&lt;DomainEventDispatcher&lt;T&gt;&gt;();
        services.AddHostedService&lt;DomainEventDispatcherService&lt;T&gt;&gt;();


        <span style="color:#66d9ef">return</span> services;
    }
}
</code></pre></div><h2 id="this-is-a-lot-of-boilerplate">This is a lot of boilerplate</h2>
<p>This seems like a lot of code to achieve what I&rsquo;d expect to be relatively straight-forward.</p>
<p>Given this is fairly common pattern and that DDD is used by a lot in software development, you&rsquo;d expect that there are frameworks that do this for you.</p>
<p>That&rsquo;s what I&rsquo;ve tried to achieve with <a href="https://github.com/TheMagnificent11/lewee">Lewee</a>.</p>
<p>However, there&rsquo;s definitely a better way.</p>
<p>In a future blog post, I&rsquo;d like to explore how to dispatch to a message broker, probably <code>RabbitMQ</code> via <a href="https://masstransit.io">MassTransit</a>, instead of using <code>Mediatr</code> notifications.  I feel like this is more flexible as any service within your distributed application can handle your domain events. not just the service that dispatches it.</p>

		</div>
	  </div>
	

</div>


    
    

  </body>

</html>
